machine:
  environment:
    AUDIODEV: null

dependencies:
  post:
    - pip install pytest pytest-cov
    - pip install coverage
    - pip install codacy-coverage

test:
  override:
    - mkdir -p $CIRCLE_TEST_REPORTS/nosetests
    - pytest --junitxml=$CIRCLE_TEST_REPORTS/nosetests/unittests.xml --cov-report term --cov=screenflow
    - coverage xml

deployment:
  coverage:
    branch: master
    commands:
      - python-codacy-coverage -r coverage.xml